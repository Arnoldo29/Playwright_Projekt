# Instructions

- Following Playwright test failed.
- Explain why, be concise, respect Playwright best practices.
- Provide a snippet of code with the fix, if possible.

# Test info

- Name: Daten fÃ¼r CoffeeShop generieren und exportieren
- Location: C:\Users\azebaze\Playwright-Kurs\testdaten_generator\DatenGenerieren.spec.ts:5:5

# Error details

```
Error: locator.click: Test timeout of 30000ms exceeded.
Call log:
  - waiting for getByRole('combobox', { name: /Exportformat auswÃ¤hlen/i })

    at ExportPage.exportiereUndLadeFormate (C:\Users\azebaze\Playwright-Kurs\Pages\API_Test.page.ts:71:37)
    at C:\Users\azebaze\Playwright-Kurs\testdaten_generator\DatenGenerieren.spec.ts:32:22
```

# Page snapshot

```yaml
- banner:
  - button "Deploy"
  - button
- heading "Testdaten-Generator" [level=1]
- text: profil
- combobox "Selected profil. Datentyp wÃ¤hlen"
- img "open"
- spinbutton "Anzahl der DatensÃ¤tze": "5"
- button
- button
- button "ðŸ› ï¸ GÃ¼ltige Daten generieren":
  - paragraph: ðŸ› ï¸ GÃ¼ltige Daten generieren
- alert:
  - paragraph: 5 gÃ¼ltige DatensÃ¤tze generiert!
- button "Download as CSV"
- button "Search"
- button "Fullscreen"
- button "âŒ UngÃ¼ltige Daten generieren":
  - paragraph: âŒ UngÃ¼ltige Daten generieren
- heading "ðŸ“¤ Daten exportieren" [level=3]
- text: json
- combobox "Selected json. Exportformat"
- img "open"
- button "ðŸ’¾ Exportieren":
  - paragraph: ðŸ’¾ Exportieren
- paragraph:
  - text: API gestartet auf
  - link "http://localhost:8001"
```

# Test source

```ts
   1 | import { Page, expect } from '@playwright/test';
   2 |
   3 | export class ExportPage {
   4 |     readonly page: Page;
   5 |     readonly dropdown;
   6 |     readonly exportFormat;
   7 |     readonly generateButton;
   8 |     readonly exportButton;
   9 |
  10 |     constructor(page: Page) {
  11 |         this.page = page;
  12 |         this.dropdown = page.getByRole('combobox', { name: /Datentyp wÃ¤hlen/i });
  13 |         this.exportFormat = page.getByRole('combobox', { name: /Exportformat auswÃ¤hlen/i });
  14 |         this.generateButton = page.getByRole('button', { name: /Daten generieren/i });
  15 |         this.exportButton = page.getByRole('button', { name: /Daten exportieren/i });
  16 |     }
  17 |
  18 |     async goto(url: string) {
  19 |         await this.page.goto(url);
  20 |         console.log("ðŸ“Œ Seite geladen");
  21 |         await this.page.waitForTimeout(2000);
  22 |     }
  23 |
  24 |     async verifyTitle(expectedTitle: string) {
  25 |         await expect(this.page).toHaveTitle(expectedTitle);
  26 |         console.log(`âœ… Seitentitel geprÃ¼ft: ${expectedTitle}`);
  27 |         await this.page.waitForTimeout(2000);
  28 |     }
  29 |
  30 |     async selectDataType(dataType: string) {
  31 |         await this.dropdown.click();
  32 |         await this.page.locator(`text=${dataType}`).first().click();
  33 |         await expect(this.dropdown).toHaveAttribute('aria-label', new RegExp(`Selected ${dataType}`, 'i'));
  34 |         console.log(`âœ… '${dataType}' als Datentyp ausgewÃ¤hlt`);
  35 |         await this.page.waitForTimeout(2000);
  36 |     }
  37 |
  38 |     async enterDataCount(count: number) {
  39 |         await this.page.fill('input[type="number"]', count.toString());
  40 |         console.log(`ðŸ“Œ ${count} DatensÃ¤tze eingegeben`);
  41 |         await this.page.waitForTimeout(2000);
  42 |     }
  43 |
  44 |     async generateData(count: number) {
  45 |         // Dynamischer Text, der die Anzahl der generierten DatensÃ¤tze enthÃ¤lt
  46 |         const confirmationText = `${count} gÃ¼ltige DatensÃ¤tze generiert!`;
  47 |     
  48 |         // Warten auf den Button zum Generieren der Daten und sicherstellen, dass er sichtbar ist
  49 |         const generateButtonLocator = this.page.locator('#root > div:nth-child(1) > div.withScreencast > div > div > section > div.stMainBlockContainer.block-container.st-emotion-cache-mtjnbi.eht7o1d4 > div > div > div > div:nth-child(4) > div > button > div');
  50 |         await expect(generateButtonLocator).toBeVisible({ timeout: 5000 });
  51 |     
  52 |         // Klick auf den Button, um die Daten zu generieren
  53 |         await generateButtonLocator.click();
  54 |     
  55 |         // BestÃ¤tigungsnachricht erwarten
  56 |         const confirmationLocator = this.page.locator(`#root > div:nth-child(1) > div.withScreencast > div > div > section > div.stMainBlockContainer.block-container.st-emotion-cache-mtjnbi.eht7o1d4 > div > div > div > div:nth-child(5) > div > div > div > div > div > div:has-text("${confirmationText}")`);
  57 |         await expect(confirmationLocator).toBeVisible({ timeout: 10000 });
  58 |     
  59 |         // Konsolen-Log zur BestÃ¤tigung der Generierung
  60 |         console.log(`âœ… ${confirmationText} erfolgreich generiert`);
  61 |     
  62 |         // Optional: Warte etwas, um sicherzustellen, dass die BestÃ¤tigung vollstÃ¤ndig sichtbar ist
  63 |         await this.page.waitForTimeout(2000);
  64 |     }
  65 |     
  66 |     
  67 |
  68 |     async exportiereUndLadeFormate(formate: string[]) {
  69 |         for (const format of formate) {
  70 |             // Format aus dem Dropdown auswÃ¤hlen
> 71 |             await this.exportFormat.click();
     |                                     ^ Error: locator.click: Test timeout of 30000ms exceeded.
  72 |             const option = this.page.getByRole('option', { name: new RegExp(format, 'i') });
  73 |             await expect(option).toBeVisible({ timeout: 5000 });
  74 |             await option.click();
  75 |     
  76 |             console.log(`ðŸ“Œ Format '${format}' ausgewÃ¤hlt`);
  77 |     
  78 |             // Exportieren-Button klicken
  79 |             await expect(this.exportButton).toBeVisible();
  80 |             await this.exportButton.click();
  81 |     
  82 |             // Warten auf den Download
  83 |             const downloadButton = this.page.getByRole('button', { name: /Download CSV \(gÃ¼ltig\)/i });
  84 |             const [download] = await Promise.all([
  85 |                 this.page.waitForEvent('download'),
  86 |                 downloadButton.first().click(), // falls mehrere vorhanden sind
  87 |             ]);
  88 |     
  89 |             const filename = await download.suggestedFilename();
  90 |             await download.saveAs(`downloads/${filename}`);
  91 |             console.log(`âœ… Datei im Format '${format}' heruntergeladen: ${filename}`);
  92 |         }
  93 |     }
  94 |     
  95 |     
  96 |     
  97 | }
  98 |
```